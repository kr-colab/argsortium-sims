---
title: "Noise processes"
author: ""
affiliation: ""
email: ""
venue: ""
date: "28 Oct 25"
date-format: "MMM D, YYYY"
format: 
  revealjs:
    html-math-method: mathjax
    theme: white
    template-partials:
      - title-slide.html
---


## Simulating noise processes

::: {.incremental}

- Simple enough to be generalizable

- Realistic enough to reveal pathologies

- "Realistic" $\sim$ dependent on genealogies

- Parametric bootstrap

:::


## Simulating noise processes

::: {.incremental}

- Genotyping error (boring)

- Mispolarisation

- Missing data

- Phasing error

- Mutation rate variation

- Structural variation

:::


## Genotyping error

::: {.incremental}

- Poisson coverage, multinomial allele counts

- Adds singletons, perturbs clades

- Not very interesting; Worth doing?

:::


## Mispolarisation

::: {.incremental}

- Add outgroup(s) to demographic model

- Use majority/parsimony to assign ancestral state

- Mispolarisation where there's ILS

- Could add "gaps" as mutations (e.g. small unalignable SVs)

:::


## Missing data

::: {.incremental}

- "inaccessible sequence" (coarse mask, independent from genealogies)

- Small SVs (e.g. missing around indels), depends on genealogies

- Lay down mutations, draw "gap size" from geometric

:::


## Phasing error

::: {.incremental}

- Simulate large ARG

- Set aside "reference panel"

- Phase remainder with shapeit

:::


## Mutation rate variation

::: {.incremental}

- Super straightforward to add

- What reversible model to use?

- Context dependence?

:::


## Structural variation

::: {.incremental}

- Simulate directly under SLiM

- How well does inference work "within" mid-frequency large SVs

- Collapsed paralogs laid on trees like for "missing data"


:::


## Current pipeline status

::: {.incremental}

- **Fully implemented**: stdpopsim + msprime + Snakemake workflow

- **Working**: Ancestry simulation, mutations (HKY/JC69/GTR), VCF output

- **Basic outgroup support**: Already simulates outgroup, outputs ancestral/outgroup FASTA

- **Planned**: Mispolarisation, missing data masking, phasing error (placeholders exist)

- **Parallelizable**: Per-chromosome execution, reproducible seeding

:::


## Project structure

::: {.columns}

::: {.column width="50%"}
**Workflow:**
```{.bash style="font-size: 0.6em;"}
argsortium-sims/
├── workflow/
│   ├── Snakefile
│   ├── rules/
│   │   ├── simulate.smk
│   │   ├── mutate.smk
│   │   └── vcf.smk
│   └── scripts/
│       ├── run_simulation.py
│       ├── add_mutations.py
│       └── write_vcf.py
├── config/
│   ├── config.yaml
│   └── examples/
└── logs/
```
:::

::: {.column width="50%"}
**Results:**
```{.bash style="font-size: 0.6em;"}
results/
└── simulations/
    └── HomSap_OutOfAfrica_3G09/
        └── chr22/
            ├── sim.trees
            ├── sim.log
            ├── sim.hapmap
            ├── sim.mutated.trees
            ├── sim.mutated.log
            ├── sim.mutated.vcf.gz
            ├── sim.mutated.vcf.log
            ├── sim.mutated.ancestral.fa.gz
            └── sim.mutated.outgroup.fa.gz
```
:::

:::


## Next steps

::: {.incremental}

- Implement mispolarisation using outgroup + parsimony

- Add geometric-distributed missing data around variants

- Integrate phasing error via shapeit/reference panels

- Add mutation rate heterogeneity across sites

- Extend to SLiM for structural variation

:::
